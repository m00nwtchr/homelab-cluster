---
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: radarr
  namespace: media
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/group: Media
    gethomepage.dev/name: Radarr
    gethomepage.dev/href: "https://radarr.svc.m00nlit.dev"
    gethomepage.dev/icon: radarr.svg
    gethomepage.dev/widget.type: radarr
    gethomepage.dev/widget.enableQueue: "true"
    gethomepage.dev/widget.url: "http://radarr.media.svc"
    gethomepage.dev/widget.key: "{{HOMEPAGE_VAR_RADARR_API_KEY}}"
spec:
  routes:
    - match: 'Host(`radarr.svc.m00nlit.dev`)'
      kind: Rule
      middlewares:
        - name: vpn-only
          namespace: traefik
        - name: auth
          namespace: traefik
      services:
        - name: radarr
          port: http
    - match: 'Host(`radarr.svc.m00nlit.dev`) && PathPrefix(`/api`)'
      kind: Rule
      middlewares:
        - name: vpn-only
          namespace: traefik
      services:
        - name: radarr
          port: http
