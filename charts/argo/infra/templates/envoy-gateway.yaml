apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: envoy-gateway
  namespace: argocd
  annotations:
    argocd.argoproj.io/sync-wave: "1"
  finalizers:
    - resources-finalizer.argocd.argoproj.io
spec:
  project: kubernetes
  source:
    repoURL: docker.io/envoyproxy
    chart: gateway-helm
    targetRevision: v1.4.1
{{/*    helm:*/}}
{{/*      valuesObject:*/}}
  destination:
    name: in-cluster
    namespace: envoy-gateway-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
      - ServerSideApply=true
---
apiVersion: gateway.networking.k8s.io/v1
kind: GatewayClass
metadata:
  name: envoy-gateway
spec:
  controllerName: gateway.envoyproxy.io/gatewayclass-controller
---
apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
metadata:
  name: envoy-gateway
spec:
  gatewayClassName: envoy-gateway
  listeners:
    - name: http
      protocol: HTTP
      port: 80
{{/*---*/}}
{{/*apiVersion: gateway.networking.k8s.io/v1*/}}
{{/*kind: HTTPRoute*/}}
{{/*metadata:*/}}
{{/*  name: backend*/}}
{{/*spec:*/}}
{{/*  parentRefs:*/}}
{{/*    - name: eg*/}}
{{/*  hostnames:*/}}
{{/*    - "www.example.com"*/}}
{{/*  rules:*/}}
{{/*    - backendRefs:*/}}
{{/*        - group: ""*/}}
{{/*          kind: Service*/}}
{{/*          name: backend*/}}
{{/*          port: 3000*/}}
{{/*          weight: 1*/}}
{{/*      matches:*/}}
{{/*        - path:*/}}
{{/*            type: PathPrefix*/}}
{{/*            value: /*/}}
