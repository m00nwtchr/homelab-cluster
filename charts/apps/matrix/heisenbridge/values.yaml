app-template:
  controllers:
    app:
      containers:
        app:
          image:
            repository: docker.io/hif1/heisenbridge
            tag: 1.15.2@sha256:2b8be67c6cb6a42b91fcbf20a80012b2639713bc0c21401cb07e3a13097dc19d
            pullPolicy: IfNotPresent
          args: [ "-c=/etc/config.yaml", "-l=::", "-p=9898", "http://conduit.matrix.svc" ]
          resources:
            requests:
              cpu: 250m
              memory: 256Mi
            limits:
              memory: 512Mi

  service:
    app:
      controller: app
      ports:
        http:
          port: 80
          targetPort: 9898

  ingress:
    media:
      annotations:
        traefik.ingress.kubernetes.io/router.tls.options: traefik-intermediate@kubernetescrd
      hosts:
        - host: "matrix.m00nlit.dev"
          paths:
            - path: /_heisenbridge/media/
              service:
                identifier: app
                port: http

  persistence:
    config:
      type: secret
      name: heisenbridge-config
      globalMounts:
        - path: /etc/config.yaml
          subPath: registration.yaml