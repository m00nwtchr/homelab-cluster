---
# yaml-language-server: $schema=https://bjw-s-labs.github.io/helm-charts/charts/app-template/values.schema.json

app-template:
  controllers:
    main:
      type: statefulset
      containers:
        main:
          image:
            repository: ossapps/splitpro
            tag: v1.3.6@sha256:ddb5aff6db38561ec5d645e0c6adddbcfa1f40d48df06a4d99170475572c3a8a
          env:
            PORT: 3000
            NEXTAUTH_URL: "https://splitpro.m00nlit.dev"

            ENABLE_SENDING_INVITES: false

            # FROM_EMAIL: "{{ .Values.env.FROM_EMAIL }}"
            # EMAIL_SERVER_HOST: "{{ .Values.env.EMAIL_SERVER_HOST }}"
            # EMAIL_SERVER_PORT: "{{ .Values.env.EMAIL_SERVER_PORT }}"
            # EMAIL_SERVER_USER: "{{ .Values.env.EMAIL_SERVER_USER }}"
            # EMAIL_SERVER_PASSWORD: "{{ .Values.env.EMAIL_SERVER_PASSWORD }}"

            AUTHENTIK_ID: "splitpro"
            AUTHENTIK_ISSUER: "https://idm.m00nlit.dev/oauth2/openid/splitpro"

            R2_ACCESS_KEY: ""
            R2_SECRET_KEY: ""
            R2_BUCKET: ""
            R2_URL: ""
            R2_PUBLIC_URL: ""

            WEB_PUSH_PRIVATE_KEY: ""
            WEB_PUSH_PUBLIC_KEY: ""
            WEB_PUSH_EMAIL: ""

            # FEEDBACK_EMAIL: "{{ .Values.env.FEEDBACK_EMAIL }}"
            # DISCORD_WEBHOOK_URL: "{{ .Values.env.DISCORD_WEBHOOK_URL }}"
          envFrom:
            - secretRef:
                name: splitpro-env

  service:
    main:
      controller: main
      ports:
        http:
          port: 80
          targetPort: 3000

  ingress:
    main:
      hosts:
        - host: splitpro.m00nlit.dev
          paths:
            - path: /
              service:
                identifier: main
                port: http