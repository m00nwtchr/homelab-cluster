---
apiVersion: v1
kind: ConfigMap
metadata:
  name: stalwart
data:
  config.toml: |
    [server.listener.smtp]
    bind = "[::]:25"
    protocol = "smtp"

    [server.listener.submission]
    bind = "[::]:587"
    protocol = "smtp"

    [server.listener.submissions]
    bind = "[::]:465"
    protocol = "smtp"
    tls.implicit = true

    [server.listener.imap]
    bind = "[::]:143"
    protocol = "imap"

    [server.listener.imaptls]
    bind = "[::]:993"
    protocol = "imap"
    tls.implicit = true

    [server.listener.pop3]
    bind = "[::]:110"
    protocol = "pop3"

    [server.listener.pop3s]
    bind = "[::]:995"
    protocol = "pop3"
    tls.implicit = true

    [server.listener.sieve]
    bind = "[::]:4190"
    protocol = "managesieve"

    [server.listener.https]
    protocol = "http"
    bind = "[::]:443"
    tls.implicit = true

    [server.listener.http]
    protocol = "http"
    bind = "[::]:8080"

    [storage]
    data = "rocksdb"
    fts = "rocksdb"
    blob = "rocksdb"
    lookup = "rocksdb"
    directory = "internal"

    [store.rocksdb]
    type = "rocksdb"
    path = "/opt/stalwart/data"
    compression = "lz4"

    [directory.internal]
    type = "internal"
    store = "rocksdb"

    [tracer.log]
    type = "log"
    level = "info"
    path = "/opt/stalwart/logs"
    prefix = "stalwart.log"
    rotate = "daily"
    ansi = false
    enable = true

    [authentication.fallback-admin]
    user = "admin"
    secret = "$6$rEc81Pi.jwdp3FkW$OZUeGFHwd4Tj.dFnRlbWfSdSX1M.gm9JsTQ/4ywMPJaDKzr8kqp5ecpK1uMS8xEu5xgUTauJE7gEFfivuSbit1"