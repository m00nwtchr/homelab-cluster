apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-config
data:
  nginx.conf: |
    worker_processes  1;

    events {
      worker_connections  1024;
    }

    http {
      include       mime.types;
      default_type  application/octet-stream;

      server {
        listen       8080;
        server_name  _;

        # Any file under /var/www/html/openpgp is served directly
        location ^~ /.well-known/openpgpkey/hu/ {
          alias /var/www/html/openpgpkey/hu/;
          try_files $uri =404;
        }

        # Hard-coded empty policy file
        location = /.well-known/openpgpkey/policy {
          default_type text/plain;
          add_header    Cache-Control "no-store, must-revalidate";
          return        200 "";
        }
      }
    }
